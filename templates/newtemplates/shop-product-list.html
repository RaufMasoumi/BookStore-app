{% extends 'newtemplates/base.html' %}
{% load static %}

{% block title %}Men category | Metronic Shop UI{% endblock %}

{% block page_level_plugin_styles %}
<!-- Page level plugin styles START -->
  <link href="{% static 'assets/plugins/fancybox/source/jquery.fancybox.css' %}" rel="stylesheet">
  <link href="{% static 'assets/plugins/owl.carousel/assets/owl.carousel.css' %}" rel="stylesheet">
  <link href="{% static 'assets/plugins/uniform/css/uniform.default.css' %}" rel="stylesheet" type="text/css">
  <link href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" rel="stylesheet" type="text/css"><!-- for slider-range -->
  <link href="{% static 'assets/plugins/rateit/src/rateit.css' %}" rel="stylesheet" type="text/css">
<!-- Page level plugin styles END -->
{% endblock %}

{% block item_list_number %}
    <div class="title-wrapper">
      <div class="container"><div class="container-inner">
        <h1><span>{{ category.title }}</span> CATEGORY</h1>
        <em>Over {{ category.books.count }} Items are available here</em>
      </div></div>
    </div>
{% endblock %}

{% block content %}
    <ul class="breadcrumb">
        <li><a href="{% url 'home' %}">Home</a></li>
        <li><a href="">Store</a></li>
        <li class="active">{{ category.title }} category</li>
    </ul>
    <!-- BEGIN SIDEBAR & CONTENT -->
    <div class="row margin-bottom-40">
      <!-- BEGIN SIDEBAR -->
      <div class="sidebar col-md-3 col-sm-5">

        {% include 'newtemplates/snippets/sidebar_category.html' %}
        <div class="sidebar-filter margin-bottom-25">
          <h2>Filter</h2>
          <form method="get" action="{% url 'category_books_list' category.pk %}">
              {% csrf_token %}
              <h3>Availability</h3>
              <div class="checkbox-list">
                <label><input type="checkbox" name="available"> Not Available ({{ category.get_unavailable_books.count }})</label>
                <label><input type="checkbox" name="unavailable"> In Stock ({{ category.get_available_books.count }})</label>
              </div>

              <h3>Price</h3>
              <p>
                <label for="amount">Range:</label>
                <input type="text" id="amount" style="border:0; color:#f6931f; font-weight:bold;">
                 <div id="slider-range"></div>
              </p>
              <button type="submit" class="btn btn-primary">Filter</button>
          </form>
        </div>
        {% include 'newtemplates/snippets/bestseller.html' %}
      </div>
      <!-- END SIDEBAR -->
      <!-- BEGIN CONTENT -->
      <div class="col-md-9 col-sm-7">
        <div class="row list-view-sorting clearfix">
          <div class="col-md-2 col-sm-2 list-view">
            <a href="javascript:;"><i class="fa fa-th-large"></i></a>
            <a href="javascript:;"><i class="fa fa-th-list"></i></a>
          </div>
          <div class="col-md-10 col-sm-10">
            <div class="pull-right">
              <label class="control-label">Show:</label>
              <select class="form-control input-sm">
                <option value="#?limit=24" selected="selected">24</option>
                <option value="#?limit=25">25</option>
                <option value="#?limit=50">50</option>
                <option value="#?limit=75">75</option>
                <option value="#?limit=100">100</option>
              </select>
            </div>
            <div class="pull-right">
              <label class="control-label">Sort&nbsp;By:</label>
              <select class="form-control input-sm">
                <option value="#?sort=p.sort_order&amp;order=ASC" selected="selected">Default</option>
                <option value="#?sort=pd.name&amp;order=ASC">Name (A - Z)</option>
                <option value="#?sort=pd.name&amp;order=DESC">Name (Z - A)</option>
                <option value="#?sort=p.price&amp;order=ASC">Price (Low &gt; High)</option>
                <option value="#?sort=p.price&amp;order=DESC">Price (High &gt; Low)</option>
                <option value="#?sort=rating&amp;order=DESC">Rating (Highest)</option>
                <option value="#?sort=rating&amp;order=ASC">Rating (Lowest)</option>
                <option value="#?sort=p.model&amp;order=ASC">Model (A - Z)</option>
                <option value="#?sort=p.model&amp;order=DESC">Model (Z - A)</option>
              </select>
            </div>
          </div>
        </div>
        <!-- BEGIN PRODUCT LIST -->
        <div class="row product-list">
        {% for book in category_books %}
          <!-- PRODUCT ITEM START -->
          <div class="col-md-4 col-sm-6 col-xs-12">
            <div class="product-item">
              <div class="pi-img-wrapper">
                <img src="{{ book.cover.url }}" class="img-responsive" alt="{{ book.title }}" style="height: 319px; width: 300px">
                <div>
                  <a href="{{ book.cover.url }}" class="btn btn-default fancybox-button">Zoom</a>
                  <a href="#product-pop-up-category-{{ book.id }}" class="btn btn-default fancybox-fast-view">View</a>
                </div>
              </div>
              <h3><a href="shop-item.html">{{ book.title }}</a></h3>
              {% if book.off %}
                <div class="pi-price">${{ book.off }}</div>
              {% else %}
                <div class="pi-price">${{ book.price }}</div>
              {% endif %}
              {% if book in user.carts.cart.all %}
                  <a href="{% url 'account_user_cart_detail' user.carts.pk %}" class="btn btn-default add2cart">Is in cart</a>
              {% else %}
                  {% if book.stock > 0 %}
                      <form action="{% url 'account_user_cart_update' %}" method="post">
                          {% csrf_token %}
                          <button type="submit" name="book_add" value="{{ book.id }}" class="btn btn-default add2cart">Add to cart</button>
                      </form>
                  {% else %}
                      <button class="btn btn-default add2cart">Unavailable</button>
                  {% endif %}
              {% endif %}
            </div>
          </div>
          <!-- PRODUCT ITEM END -->
        {% endfor %}
        </div>
        <!-- END PRODUCT LIST -->
        <!-- BEGIN PAGINATOR -->
        {% if is_paginated %}
        <div class="row">
          <div class="col-md-4 col-sm-4 items-info">Items {{ page_obj.start_index }} to {{ page_obj.end_index }} of {{ category.books.published.count }} total</div>
          <div class="col-md-8 col-sm-8">
            <ul class="pagination pull-right">
              {% if page_obj.has_previous %}
                <li><a href="{% url 'category_books_list' category.pk page_obj.previous_page_number %}">&laquo;</a></li>
              {% else %}
                <li><a>&laquo;</a></li>
              {% endif %}
              {% for number in paginator.page_range %}
                  {% if number == page_obj.number %}
                    <li><span>{{ number }}</span></li>
                  {% else %}
                    <li><a href="{% url 'category_books_list' category.pk number %}">{{ number }}</a></li>
                  {% endif %}
              {% endfor %}
              {% if page_obj.has_next %}
                <li><a href="{% url 'category_books_list' category.pk page_obj.next_page_number %}">&raquo;</a></li>
              {% else %}
                <li><a>&raquo;</a></li>
              {% endif %}
            </ul>
          </div>
        </div>
        {% endif %}
        <!-- END PAGINATOR -->
      </div>
      <!-- END CONTENT -->
    </div>
    <!-- END SIDEBAR & CONTENT -->
{% endblock %}

{% block fast_view_of_products %}
    {% for book in category_books %}
    <div id="product-pop-up-category-{{ book.id }}" style="display: none; width: 700px;">
        <div class="product-page product-pop-up">
          <div class="row">
            <div class="col-md-6 col-sm-6 col-xs-3">
              <div class="product-main-image">
                <img src="{{ book.cover.url }}" alt="{{ book.title }}" class="img-responsive">
              </div>
              <div class="product-other-images">
                {% for image in book.images.all %}
                    <a href="{{ book.get_absolute_url }}"><img alt="{{ book.title }}" src="{{ image.image.url }}"></a>
                {% endfor %}
              </div>
            </div>
            <div class="col-md-6 col-sm-6 col-xs-9">
              <h2>{{ book.title }}</h2>
              <div class="price-availability-block clearfix">
                <div class="price">
                  {% if book.off %}
                      <strong><span>$</span>{{ book.off }}</strong>
                      <em>$<span>{{ book.price }}</span></em>
                  {% else %}
                      <strong><span>$</span>{{ book.price }}</strong>
                  {% endif %}
                </div>
                <div class="availability">
                  {% if book.stock > 0 %}
                    Availability: <strong>In Stock</strong>
                  {% else %}
                    Availability: <strong>Not in Stock</strong>
                  {% endif %}
                </div>
              </div>
              <div class="description">
                <p>{{ book.summary }}</p>
              </div>
              <div class="product-page-cart">
                {% if book.stock > 0 %}
                    <div class="product-quantity">
                    <form action="{% url 'account_user_cart_update' %}" method="post">
                      {% csrf_token %}
                        {% if book in user.carts.cart.all %}
                            {% for number in user.carts.books_numbers.all %}
                            {% if number.book == book %}
                                <input id="product-quantity" name="quantity" type="text" value="{{ number.number }}" readonly class="form-control input-sm">
                            </div>
                                <button class="btn btn-primary" name="number" value="{{ number.id }}" type="submit">Edit cart</button>
                                | <button class="btn btn-danger" name="delete" value="{{ number.id }}" type="submit">Delete from cart</button>
                                <hr>
                            {% endif %}
                            {% endfor %}
                        {% else %}
                                <input id="product-quantity" name="quantity" type="text" value="1" readonly class="form-control input-sm">
                            </div>
                            <button class="btn btn-primary" name="book" value="{{ book.id }}" type="submit">Add to cart</button>
                        {% endif %}
                    </form>
                {% else %}
                    <button class="btn btn-primary" type="button">Unavailable</button>
                {% endif %}
                <a href="{{ book.get_absolute_url }}" class="btn btn-default">More details</a>
              </div>
            </div>
          </div>
        </div>
    </div>
    {% endfor %}
{% endblock %}

{% block page_level_javascripts %}
<!-- BEGIN PAGE LEVEL JAVASCRIPTS (REQUIRED ONLY FOR CURRENT PAGE) -->
    <script src="{% static 'assets/plugins/fancybox/source/jquery.fancybox.pack.js' %}" type="text/javascript"></script><!-- pop up -->
    <script src="{% static 'assets/plugins/owl.carousel/owl.carousel.min.js' %}" type="text/javascript"></script><!-- slider for products -->
    <script src="{% static 'assets/plugins/zoom/jquery.zoom.min.js' %}" type="text/javascript"></script><!-- product zoom -->
    <script src="{% static 'assets/plugins/bootstrap-touchspin/bootstrap.touchspin.js' %}" type="text/javascript"></script><!-- Quantity -->
    <script src="{% static 'assets/plugins/uniform/jquery.uniform.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'assets/plugins/rateit/src/jquery.rateit.js' %}" type="text/javascript"></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js' %}" type="text/javascript"></script><!-- for slider-range -->

    <script src="{% static 'assets/corporate/scripts/layout.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        jQuery(document).ready(function() {
            Layout.init();
            Layout.initOWL();
            Layout.initTwitter();
            Layout.initImageZoom();
            Layout.initTouchspin();
            Layout.initUniform();
            Layout.initSliderRange();
        });
    </script>
<!-- END PAGE LEVEL JAVASCRIPTS -->
{% endblock %}
